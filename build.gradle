/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * user guide available at https://docs.gradle.org/4.8/userguide/java_library_plugin.html
 */

buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'com.adaptc.gradle:nexus-workflow:0.6'
    }
}

plugins {
    id 'net.researchgate.release' version '2.6.0'
    id 'java-library'
    id "org.jetbrains.kotlin.jvm" version '1.2.50'
    id 'org.jetbrains.dokka' version '0.9.17'
    id 'maven-publish'
    id 'maven'
    id 'signing'
}

ext.kotlin_version = '1.2.50'
ext.weka_version = '3.8.2'
ext.dokka_version = '0.9.17'


// Define project dependencies
dependencies {
    compile "nz.ac.waikato.cms.weka:weka-stable:$weka_version"
    compile "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"

    testImplementation 'junit:junit:4.12'
}

// In this section you declare where to find the dependencies of your project
repositories {
    // Use jcenter for resolving your dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
    mavenCentral()
}

// Dokka setup
dokka {
    outputFormat = 'html'
    outputDirectory = "$buildDir/javadoc"
}

task dokkaJavadoc(type: org.jetbrains.dokka.gradle.DokkaTask) {
    outputFormat = 'javadoc'
    outputDirectory = javadoc.destinationDir
    inputs.dir 'src/main/kotlin'
}

task javadocJar(type: Jar, dependsOn: dokkaJavadoc) {
    classifier = 'javadoc'
    from javadoc.destinationDir
}

task sourceJar(type: Jar) {
    from sourceSets.main.allJava
    classifier "sources"
}

// Publishing task via maven-publish
publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
            artifact sourceJar
            artifact javadocJar

            groupId 'com.github.slang03'
            artifactId 'weka-kt'
            version '0.0.3-SNAPSHOT'

            pom {
                name = "weka-kt"
                description = "Kotlin Extensions for Weka."
                url = "http://www.github.com/slang03/weka-kt"
                licenses {
                    license {
                        name = "GNU General Public License 3"
                        url = "http://www.gnu.org/licenses/gpl-3.0.txt"
                    }
                }
                developers {
                    developer {
                        id = "slang03"
                        name = "Steven Lang"
                        email = "steven.lang.mz@gmail.com"
                    }
                }
                scm {
                    connection = "scm:git:https://github.com/slang03/weka-kt"
                    developerConnection = "scm:git:https://github.com/slang03/weka-kt"
                    url = "https://github.com/slang03/weka-kt"
                }
            }
        }
    }

    repositories {
        maven {
            url "https://oss.sonatype.org/service/local/staging/deploy/maven2"

            credentials {
                println(project.nexusUsername)  //prints the value
                username = project.nexusUsername
                password = project.nexusPassword
            }
        }
    }
}

// Signing task
signing {
    sign publishing.publications.mavenJava
}
